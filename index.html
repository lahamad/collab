<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SWAG — Men’s Style Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-0: #0b0b0f; /* base */
      --bg-1: #0f0f15; /* cards */
      --bg-2: #14141d; /* surfaces */
      --text-0: #fafafa;
      --text-1: #c9c9d1;
      --accent: #7c5cff; /* purple */
      --accent-2: #22d3ee; /* cyan */
      --success: #22c55e;
      --warning: #f59e0b;
      --danger: #ef4444;
      --muted: #32323f;
      --shadow: rgba(0,0,0,.55);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text-0);
      background:
        radial-gradient(1200px 800px at 80% -10%, rgba(124,92,255,.18), transparent 60%),
        radial-gradient(1200px 800px at -10% 100%, rgba(34,211,238,.15), transparent 60%),
        linear-gradient(180deg, #0a0a0e 0%, #0b0b10 30%, #09090c 100%);
      background-attachment: fixed;
    }

    /* Header / Navbar */
    .nav {
      position: sticky;
      top: 0;
      z-index: 50;
      backdrop-filter: saturate(140%) blur(8px);
      background: linear-gradient(180deg, rgba(15,15,20,.85), rgba(15,15,20,.55));
      border-bottom: 1px solid rgba(255,255,255,.06);
    }
    .nav-inner { display: flex; align-items: center; gap: 16px; padding: 12px 20px; max-width: 1280px; margin: 0 auto; }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: 800; letter-spacing: .08em; }
    .brand .logo {
      width: 36px; height: 36px; display: grid; place-items: center;
      background: conic-gradient(from 180deg at 50% 50%, #7c5cff, #22d3ee, #7c5cff);
      border-radius: 12px; box-shadow: 0 6px 30px rgba(124,92,255,.35), inset 0 0 0 2px rgba(255,255,255,.08);
      font-weight: 900;
    }
    .brand span { font-size: 18px; }

    .menu { display: flex; gap: 14px; margin-left: 10px; }
    .menu a {
      color: var(--text-1); text-decoration: none; padding: 8px 12px; border-radius: 10px; font-weight: 600; font-size: 14px;
    }
    .menu a.active, .menu a:hover { color: var(--text-0); background: rgba(124,92,255,.15); }

    .spacer { flex: 1; }

    .search { position: relative; }
    .search input {
      width: 340px; background: #0d0d14; border: 1px solid rgba(255,255,255,.08); color: var(--text-0);
      padding: 10px 12px 10px 38px; border-radius: 12px; outline: none;
    }
    .search svg { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); opacity: .7; }

    .icons { display: flex; align-items: center; gap: 10px; }
    .icon-btn { background: #0e0e15; border: 1px solid rgba(255,255,255,.08); width: 36px; height: 36px; border-radius: 10px; display: grid; place-items: center; cursor: pointer; }
    .icon-btn:hover { border-color: rgba(124,92,255,.5); }

    /* Toolbar (Filters + Optional Quick Filters) */
    .toolbar { max-width: 1280px; margin: 14px auto 0; display: grid; gap: 12px; grid-template-columns: 1fr auto; padding: 0 20px 8px; }
    .filters { display: flex; gap: 10px; flex-wrap: wrap; }
    .select, .range, .toggle {
      background: var(--bg-2); border: 1px solid rgba(255,255,255,.08); border-radius: 12px; padding: 10px 12px; color: var(--text-1); font-size: 14px;
    }
    select, input[type="range"], input[type="checkbox"] { background: transparent; color: inherit; border: none; outline: none; }
    .range { display: flex; align-items: center; gap: 10px; }
    .chipbar { display: flex; gap: 8px; flex-wrap: wrap; justify-content: flex-end; }
    .chip { background: rgba(124,92,255,.18); color: #e9e6ff; border: 1px solid rgba(124,92,255,.35); padding: 8px 12px; border-radius: 999px; font-weight: 600; cursor: pointer; }
    .chip[aria-pressed="true"] { background: rgba(34,211,238,.2); border-color: rgba(34,211,238,.5); }

    /* Settings Drawer */
    .settings-drawer { position: fixed; top: 0; right: -360px; width: 340px; height: 100vh; background: #0e0e15; border-left: 1px solid rgba(255,255,255,.08); box-shadow: -10px 0 30px var(--shadow); transition: right .35s ease; z-index: 60; }
    .settings-drawer.open { right: 0; }
    .settings-inner { padding: 18px; display: grid; gap: 14px; }
    .settings-inner h3 { margin: 6px 0 4px; }
    .setting-row { background: var(--bg-2); border: 1px solid rgba(255,255,255,.08); border-radius: 12px; padding: 12px; display: grid; gap: 8px; }

    /* Grid */
    .grid { max-width: 1280px; margin: 8px auto 60px; padding: 0 20px; display: grid; gap: 16px; grid-template-columns: repeat(12, 1fr); }

    .card { grid-column: span 4; background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.005)); border: 1px solid rgba(255,255,255,.08); border-radius: 18px; overflow: hidden; position: relative; box-shadow: 0 10px 30px var(--shadow); transform-style: preserve-3d; perspective: 1000px; }
    @media (max-width: 1024px){ .card { grid-column: span 6; } }
    @media (max-width: 640px){ .card { grid-column: span 12; } .search input{ width: 100%; } }

    .media { position: relative; height: 320px; overflow: hidden; background: #0b0b11; display: grid; place-items: center; }
    .media img { width: 110%; height: 110%; object-fit: cover; transform: translateZ(40px) scale(1.02); transition: transform .6s ease; will-change: transform; }

    .floaty { position: absolute; inset: 0; background: radial-gradient(120px 80px at var(--mx,50%) var(--my,50%), rgba(124,92,255,.25), transparent 60%); pointer-events: none; mix-blend-mode: screen; opacity: .4; transition: opacity .2s ease; }

    .badge { position: absolute; top: 12px; left: 12px; background: linear-gradient(90deg, #7c5cff, #22d3ee); color: #0b0b10; padding: 6px 10px; font-weight: 800; border-radius: 999px; font-size: 12px; letter-spacing: .06em; }
    .offer { position: absolute; top: 12px; right: -40px; transform: rotate(35deg); background: #16a34a; color: white; padding: 6px 50px; font-weight: 800; letter-spacing: .08em; box-shadow: 0 8px 24px rgba(22,163,74,.35); }

    .content { padding: 14px; display: grid; gap: 8px; }
    .title { font-weight: 800; font-size: 18px; letter-spacing: .02em; }
    .meta { display: flex; align-items: center; gap: 10px; color: var(--text-1); font-size: 13px; }
    .price { font-weight: 800; font-size: 20px; }
    .price s { opacity: .55; font-weight: 600; font-size: 14px; margin-left: 6px; }

    .actions { display: flex; gap: 10px; margin-top: 6px; }
    .btn { flex: 1; display: inline-flex; justify-content: center; align-items: center; gap: 8px; padding: 10px 12px; border-radius: 12px; font-weight: 700; letter-spacing: .02em; cursor: pointer; border: 1px solid rgba(255,255,255,.08); background: #11111a; color: var(--text-0); text-decoration: none; }
    .btn:hover { border-color: rgba(124,92,255,.5); }
    .btn.primary { background: linear-gradient(90deg, rgba(124,92,255,.9), rgba(34,211,238,.9)); color: #0b0b10; border: none; }

    /* Motion */
    .card:hover .media img { transform: translateZ(60px) scale(1.06) rotateZ(.2deg); }
    .card { transition: transform .35s ease, box-shadow .35s ease; }
    .card:hover { transform: translateY(-6px); box-shadow: 0 18px 50px var(--shadow); }

    /* 3D Viewer Modal */
    .modal { position: fixed; inset: 0; display: none; place-items: center; background: rgba(0,0,0,.6); z-index: 70; }
    .modal.open { display: grid; }
    .modal-card { width: min(92vw, 980px); background: #0f0f16; border: 1px solid rgba(255,255,255,.08); border-radius: 18px; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,.6); }
    .modal-header { display: flex; align-items: center; justify-content: space-between; padding: 12px 14px; border-bottom: 1px solid rgba(255,255,255,.08); }
    .modal-body { padding: 0; }
    .viewer { width: 100%; height: 520px; background: radial-gradient(600px 300px at 50% 0%, rgba(124,92,255,.2), transparent 70%), #0c0c12; }
    .modal-actions { display: flex; gap: 10px; padding: 12px; border-top: 1px solid rgba(255,255,255,.08); }

    /* Footer */
    footer { max-width: 1280px; margin: 0 auto; padding: 24px 20px 60px; color: var(--text-1); border-top: 1px solid rgba(255,255,255,.06); }
    .foot-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 18px; }
    @media (max-width: 900px) { .foot-grid { grid-template-columns: repeat(2,1fr); } }
    @media (max-width: 560px) { .foot-grid { grid-template-columns: 1fr; } }

    .pulse { animation: pulse 3s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{opacity:.8} 50%{opacity:1} }

  </style>
</head>
<body>
  <!-- NAVBAR -->
  <header class="nav">
    <div class="nav-inner">
      <div class="brand" aria-label="SWAG – site brand">
        <div class="logo">S</div>
        <span>SWAG</span>
      </div>
      <nav class="menu" aria-label="Primary">
        <a href="#" class="active">Home</a>
        <a href="#collections">Collections</a>
        <a href="#offers">Offers</a>
        <a href="#about">About</a>
        <a href="#contact">Contact</a>
      </nav>
      <div class="spacer"></div>
      <div class="search" role="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z" stroke="currentColor" stroke-width="1.6"/></svg>
        <input id="search" placeholder="Search styles, e.g. bomber, kurta, suit…" />
      </div>
      <div class="icons">
        <button class="icon-btn" id="openSettings" title="Settings" aria-label="Open settings">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" stroke="currentColor" stroke-width="1.6"/><path d="M19.4 15a1.7 1.7 0 0 0 .34 1.87l.05.05a2 2 0 1 1-2.83 2.83l-.05-.05a1.7 1.7 0 0 0-1.87-.34 1.7 1.7 0 0 0-1 1.54V21a2 2 0 1 1-4 0v-.1a1.7 1.7 0 0 0-1-1.54 1.7 1.7 0 0 0-1.87.34l-.05.05a2 2 0 1 1-2.83-2.83l.05-.05a1.7 1.7 0 0 0 .34-1.87 1.7 1.7 0 0 0-1.54-1H3a2 2 0 1 1 0-4h.1a1.7 1.7 0 0 0 1.54-1 1.7 1.7 0 0 0-.34-1.87l-.05-.05A2 2 0 0 1 7.08 3.3l.05.05a1.7 1.7 0 0 0 1.87.34H9a1.7 1.7 0 0 0 1-1.54V2.99a2 2 0 1 1 4 0v.1a1.7 1.7 0 0 0 1 1.54 1.7 1.7 0 0 0 1.87-.34l.05-.05a2 2 0 1 1 2.83 2.83l-.05.05a1.7 1.7 0 0 0-.34 1.87v.02c0 .66.39 1.27 1 1.54H21a2 2 0 1 1 0 4h-.1c-.67 0-1.28.39-1.54 1Z" stroke="currentColor" stroke-width="1.6"/></svg>
        </button>
        <button class="icon-btn" title="Cart" aria-label="Cart">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 6h14l-1.2 8.4a2 2 0 0 1-2 1.6H9a2 2 0 0 1-2-1.6L6 6Z" stroke="currentColor" stroke-width="1.6"/><path d="M6 6 5 3H3" stroke="currentColor" stroke-width="1.6"/><circle cx="9" cy="20" r="1.5" fill="currentColor"/><circle cx="17" cy="20" r="1.5" fill="currentColor"/></svg>
        </button>
      </div>
    </div>
  </header>

  <!-- TOOLBAR -->
  <section class="toolbar" aria-label="Filters">
    <div class="filters">
      <label class="select">Category
        <select id="filterCategory">
          <option value="">All</option>
          <option>Formal</option>
          <option>Casual</option>
          <option>Ethnic</option>
          <option>Streetwear</option>
          <option>Activewear</option>
        </select>
      </label>
      <label class="select">Size
        <select id="filterSize">
          <option value="">All</option>
          <option>XS</option>
          <option>S</option>
          <option>M</option>
          <option>L</option>
          <option>XL</option>
        </select>
      </label>
      <div class="range" title="Price range">
        <span>₹</span>
        <input id="priceRange" type="range" min="999" max="9999" step="100" value="9999" />
        <span id="priceValue">₹9,999</span>
      </div>
      <label class="select">Sort by
        <select id="sortBy">
          <option value="pop">Popularity</option>
          <option value="low">Price: Low to High</option>
          <option value="high">Price: High to Low</option>
          <option value="new">Newest</option>
        </select>
      </label>
      <label class="toggle" title="Only show deals">
        <input id="onlyDeals" type="checkbox" /> Deals only
      </label>
    </div>

    <!-- Optional Quick Filters -->
    <div class="chipbar" aria-label="Quick filters">
      <button class="chip" data-chip="new">New Arrivals</button>
      <button class="chip" data-chip="bestseller">Best Sellers</button>
      <button class="chip" data-chip="festive">Festive</button>
      <button class="chip" data-chip="minimal">Minimal</button>
      <button class="chip" data-chip="premium">Premium</button>
    </div>
  </section>

  <!-- PRODUCTS GRID -->
  <main class="grid" id="grid" aria-live="polite"></main>

  <!-- SETTINGS DRAWER -->
  <aside class="settings-drawer" id="settings">
    <div class="settings-inner">
      <h3>Settings</h3>
      <div class="setting-row">
        <strong>Density</strong>
        <label><input type="radio" name="density" value="cozy" checked> Cozy</label>
        <label><input type="radio" name="density" value="compact"> Compact</label>
      </div>
      <div class="setting-row">
        <strong>Motion</strong>
        <label><input type="checkbox" id="reduceMotion"> Reduce motion</label>
      </div>
      <div class="setting-row">
        <strong>Currency</strong>
        <select id="currency">
          <option value="INR" selected>INR (₹)</option>
          <option value="USD">USD ($)</option>
          <option value="EUR">EUR (€)</option>
        </select>
      </div>
      <div class="setting-row">
        <strong>About SWAG</strong>
        <p class="text-sm">SWAG is a demo storefront showcasing stylish men’s costumes with interactive 3D previews, a black-gradient theme, and business-ready UI.</p>
      </div>
    </div>
  </aside>

  <!-- 3D VIEWER MODAL -->
  <div class="modal" id="viewerModal" aria-hidden="true" aria-label="3D viewer">
    <div class="modal-card">
      <div class="modal-header">
        <div style="display:flex;align-items:center;gap:8px">
          <strong id="viewerTitle">3D View</strong>
          <span id="viewerPrice" style="opacity:.7;font-weight:600"></span>
        </div>
        <button class="icon-btn" id="closeViewer" aria-label="Close viewer">✕</button>
      </div>
      <div class="modal-body">
        <div id="viewer" class="viewer"></div>
      </div>
      <div class="modal-actions">
        <button class="btn" id="spinToggle">Pause Spin</button>
        <a class="btn primary" href="#" id="ctaBuy">Buy Now</a>
      </div>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  <script>
    // --- DATA (demo) --------------------------------------------------------
    const PRODUCTS = [
      {
        id: 'bomber-neo',
        name: 'Neo Bomber Jacket',
        category: 'Streetwear', size: 'M', priceINR: 4599, priceUSD: 69, priceEUR: 64,
        popular: true, tags: ['new', 'minimal'], deal: 20,
        img: 'https://images.unsplash.com/photo-1516826957135-700dedea698c?q=80&w=1600&auto=format&fit=crop',
        caption: 'Matte black finish, ribbed cuffs, zip pockets.'
      },
      {
        id: 'kurta-silk',
        name: 'Silk Kurta Set',
        category: 'Ethnic', size: 'L', priceINR: 5299, priceUSD: 79, priceEUR: 74,
        popular: true, tags: ['festive','premium'], deal: 30,
        img: 'https://images.unsplash.com/photo-1694521701486-15640e8765fd?q=80&w=1600&auto=format&fit=crop',
        caption: 'Hand-finished embroidery, breathable silk blend.'
      },
      {
        id: 'tux-classic',
        name: 'Classic Tuxedo',
        category: 'Formal', size: 'XL', priceINR: 9499, priceUSD: 139, priceEUR: 129,
        popular: false, tags: ['premium'], deal: 15,
        img: 'https://images.unsplash.com/photo-1516675302207-c0bcb2a92c04?q=80&w=1600&auto=format&fit=crop',
        caption: 'Peak lapel, tailored fit, satin accents.'
      },
      {
        id: 'tee-oversize',
        name: 'Oversized Tee',
        category: 'Casual', size: 'L', priceINR: 1299, priceUSD: 19, priceEUR: 18,
        popular: true, tags: ['bestseller','minimal'], deal: 10,
        img: 'https://images.unsplash.com/photo-1491349174775-aaafddd81942?q=80&w=1600&auto=format&fit=crop',
        caption: 'Heavyweight cotton, drop-shoulder cut.'
      },
      {
        id: 'tracks-jet',
        name: 'Jet Tracksuit',
        category: 'Activewear', size: 'M', priceINR: 2899, priceUSD: 42, priceEUR: 39,
        popular: false, tags: ['new'], deal: 25,
        img: 'https://images.unsplash.com/photo-1534091999211-756c1fa3be56?q=80&w=1600&auto=format&fit=crop',
        caption: 'Moisture-wicking tech, reflective trims.'
      },
      {
        id: 'denim-indigo',
        name: 'Indigo Denim Jacket',
        category: 'Casual', size: 'M', priceINR: 3499, priceUSD: 52, priceEUR: 48,
        popular: true, tags: ['bestseller'], deal: 18,
        img: 'https://images.unsplash.com/photo-1490111718993-d98654ce6cf7?q=80&w=1600&auto=format&fit=crop',
        caption: 'Selvedge-inspired, classic trucker silhouette.'
      }
    ];

    // --- Helpers ------------------------------------------------------------
    const fmt = (n, cur) => {
      const opts = { style: 'currency', currency: cur };
      return new Intl.NumberFormat('en-IN', opts).format(n);
    };

    // --- Render Grid --------------------------------------------------------
    const grid = document.getElementById('grid');
    let currency = 'INR';

    function productPrice(p){
      if (currency === 'USD') return p.priceUSD;
      if (currency === 'EUR') return p.priceEUR;
      return p.priceINR;
    }

    function cardTemplate(p){
      const price = productPrice(p);
      const oldPrice = Math.round(price / (1 - p.deal/100));
      return `
        <article class="card" data-id="${p.id}" data-category="${p.category}" data-size="${p.size}" data-tags="${p.tags.join(',')}" data-price="${price}">
          <div class="media" data-tilt>
            <img alt="${p.name}" src="${p.img}" loading="lazy" />
            <div class="floaty"></div>
            <span class="badge">${p.category}</span>
            ${p.deal?`<span class="offer">${p.deal}% OFF</span>`:''}
          </div>
          <div class="content">
            <div class="title">${p.name}</div>
            <div class="meta">${p.caption}</div>
            <div class="price">${fmt(price, currency)} <s>${fmt(oldPrice, currency)}</s></div>
            <div class="actions">
              <button class="btn view3d">View 3D</button>
              <a class="btn primary" href="#">Add to Cart</a>
            </div>
          </div>
        </article>
      `;
    }

    function render(products){
      grid.innerHTML = products.map(cardTemplate).join('');
      attachCardEffects();
      attach3DHandlers();
    }

    // Initial render
    render(PRODUCTS);

    // --- Filters & Search ---------------------------------------------------
    const filterCategory = document.getElementById('filterCategory');
    const filterSize = document.getElementById('filterSize');
    const priceRange = document.getElementById('priceRange');
    const priceValue = document.getElementById('priceValue');
    const sortBy = document.getElementById('sortBy');
    const onlyDeals = document.getElementById('onlyDeals');
    const search = document.getElementById('search');

    function applyFilters(){
      const cat = filterCategory.value;
      const size = filterSize.value;
      const maxPrice = +priceRange.value;
      const searchTerm = search.value.toLowerCase().trim();
      const chipsActive = [...document.querySelectorAll('.chip[aria-pressed="true"]')].map(c=>c.dataset.chip);

      let list = PRODUCTS.filter(p => productPrice(p) <= convertPrice(maxPrice));
      if (cat) list = list.filter(p => p.category === cat);
      if (size) list = list.filter(p => p.size === size);
      if (onlyDeals.checked) list = list.filter(p => p.deal && p.deal > 0);
      if (chipsActive.length) list = list.filter(p => chipsActive.every(t => p.tags.includes(t)));
      if (searchTerm) list = list.filter(p => (p.name + ' ' + p.caption).toLowerCase().includes(searchTerm));

      // Sort
      if (sortBy.value === 'low') list.sort((a,b)=>productPrice(a)-productPrice(b));
      if (sortBy.value === 'high') list.sort((a,b)=>productPrice(b)-productPrice(a));
      if (sortBy.value === 'new') list = list.slice().reverse();

      render(list);
    }

    // Convert slider INR max to current currency for comparison
    function convertPrice(valInINR){
      if (currency === 'INR') return valInINR;
      const fx = { USD: 75, EUR: 80 }; // simple demo conversion baseline
      return Math.round(valInINR / fx[currency]);
    }

    [filterCategory, filterSize, sortBy, onlyDeals].forEach(el=> el.addEventListener('change', applyFilters));
    [priceRange].forEach(el=> el.addEventListener('input', () => { priceValue.textContent = '₹' + (+priceRange.value).toLocaleString('en-IN'); applyFilters(); }));
    search.addEventListener('input', applyFilters);

    // Quick filter chips
    document.querySelectorAll('.chip').forEach(ch => ch.addEventListener('click', () => {
      const pressed = ch.getAttribute('aria-pressed') === 'true';
      ch.setAttribute('aria-pressed', !pressed);
      applyFilters();
    }));

    // --- Card 3D tilt + glow ------------------------------------------------
    function attachCardEffects(){
      document.querySelectorAll('[data-tilt]').forEach(el => {
        const floaty = el.querySelector('.floaty');
        function move(e){
          const rect = el.getBoundingClientRect();
          const x = (e.clientX - rect.left) / rect.width; // 0..1
          const y = (e.clientY - rect.top) / rect.height;
          const rx = (y - .5) * -8;
          const ry = (x - .5) * 12;
          el.style.transform = `perspective(900px) rotateX(${rx}deg) rotateY(${ry}deg)`;
          el.style.transition = 'transform .05s linear';
          el.style.transformStyle = 'preserve-3d';
          floaty && (floaty.style.setProperty('--mx', (x*100)+'%'), floaty.style.setProperty('--my', (y*100)+'%'));
        }
        function leave(){ el.style.transform = 'none'; }
        el.addEventListener('mousemove', move);
        el.addEventListener('mouseleave', leave);
      });
    }

    // --- Settings Drawer ----------------------------------------------------
    const settings = document.getElementById('settings');
    document.getElementById('openSettings').addEventListener('click', ()=> settings.classList.toggle('open'));

    document.querySelectorAll('input[name="density"]').forEach(r => r.addEventListener('change', (e)=>{
      document.body.style.setProperty('--card-gutter', e.target.value==='compact' ? '10px' : '16px');
      document.querySelectorAll('.card .content').forEach(c=> c.style.padding = e.target.value==='compact' ? '10px' : '14px');
    }));

    document.getElementById('reduceMotion').addEventListener('change', (e)=>{
      const reduce = e.target.checked;
      document.querySelectorAll('.card').forEach(c => c.style.transition = reduce ? 'none' : 'transform .35s ease, box-shadow .35s ease');
    });

    const currencySel = document.getElementById('currency');
    currencySel.addEventListener('change', (e)=>{
      currency = e.target.value;
      applyFilters();
    });

    // --- 3D Viewer with three.js -------------------------------------------
    let three = { scene:null, camera:null, renderer:null, mesh:null, anim:null, spinning:true };

    function initViewer(textureURL){
      const container = document.getElementById('viewer');
      // cleanup
      if (three.renderer) { three.renderer.dispose(); container.innerHTML=''; }

      const scene = new THREE.Scene();
      const camera = new THREE.PerspectiveCamera(45, container.clientWidth/container.clientHeight, 0.1, 100);
      camera.position.set(0, 0.3, 2.8);

      const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
      renderer.setSize(container.clientWidth, container.clientHeight);
      container.appendChild(renderer.domElement);

      const hemi = new THREE.HemisphereLight(0xffffff, 0x202030, 1.2);
      scene.add(hemi);
      const dir = new THREE.DirectionalLight(0xffffff, 1);
      dir.position.set(2,2,2);
      scene.add(dir);

      const geometry = new THREE.BoxGeometry(1.6, 2.2, 0.6);
      const loader = new THREE.TextureLoader();
      const mat = new THREE.MeshStandardMaterial({ map: loader.load(textureURL) });
      const mesh = new THREE.Mesh(geometry, mat);
      scene.add(mesh);

      const plane = new THREE.Mesh(new THREE.PlaneGeometry(20, 20), new THREE.ShadowMaterial({ opacity: 0.15 }));
      plane.position.y = -1.2; plane.rotation.x = -Math.PI/2; plane.receiveShadow = true;
      // scene.add(plane); // subtle

      function onResize(){
        const w = container.clientWidth, h = container.clientHeight;
        renderer.setSize(w, h);
        camera.aspect = w/h; camera.updateProjectionMatrix();
      }
      window.addEventListener('resize', onResize);

      function animate(){
        if (three.spinning) mesh.rotation.y += 0.008;
        renderer.render(scene, camera);
        three.anim = requestAnimationFrame(animate);
      }
      animate();

      three = { scene, camera, renderer, mesh, anim: three.anim, spinning: true };
    }

    function openViewer(p){
      document.getElementById('viewerTitle').textContent = p.name;
      document.getElementById('viewerPrice').textContent = '· ' + fmt(productPrice(p), currency);
      document.getElementById('viewerModal').classList.add('open');
      document.getElementById('viewerModal').setAttribute('aria-hidden','false');
      initViewer(p.img);
      const cta = document.getElementById('ctaBuy'); cta.href = `#buy-${p.id}`;
    }

    function closeViewer(){
      document.getElementById('viewerModal').classList.remove('open');
      document.getElementById('viewerModal').setAttribute('aria-hidden','true');
      if (three.anim) cancelAnimationFrame(three.anim);
      if (three.renderer) three.renderer.dispose();
      document.getElementById('viewer').innerHTML = '';
    }

    document.getElementById('closeViewer').addEventListener('click', closeViewer);
    document.getElementById('viewerModal').addEventListener('click', (e)=>{ if(e.target.id==='viewerModal') closeViewer(); });
    document.getElementById('spinToggle').addEventListener('click', (e)=>{
      three.spinning = !three.spinning;
      e.target.textContent = three.spinning ? 'Pause Spin' : 'Resume Spin';
    });

    function attach3DHandlers(){
      document.querySelectorAll('.view3d').forEach(btn => btn.addEventListener('click', (e)=>{
        const id = e.target.closest('.card').dataset.id;
        const p = PRODUCTS.find(x=>x.id===id);
        openViewer(p);
      }));
    }

    // --- Intersection animations -------------------------------------------
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if (e.isIntersecting) {
          e.target.animate([
            { transform: 'translateY(14px)', opacity: .001 },
            { transform: 'translateY(0px)', opacity: 1 }
          ], { duration: 480, easing: 'cubic-bezier(.2,.7,.2,1)', fill: 'forwards' });
          io.unobserve(e.target);
        }
      })
    }, { threshold: .12 });

    const observeGrid = () => document.querySelectorAll('.card').forEach(c=> io.observe(c));
    observeGrid();

    // Re-observe after each render
    const observer = new MutationObserver(observeGrid);
    observer.observe(grid, { childList: true });

    // Price range initial label
    priceValue.textContent = '₹' + (+priceRange.value).toLocaleString('en-IN');
  </script>

  <footer id="about">
    <div class="foot-grid">
      <div>
        <div class="brand" style="margin-bottom:8px">
          <div class="logo">S</div><span>SWAG</span>
        </div>
        <p>Business-ready, stylish men’s costumes storefront with a modern dashboard experience, black gradient theme, 3D previews, pricing & offers.</p>
      </div>
      <div>
        <strong>Help</strong>
        <p>Shipping & Returns<br/>Size Guide<br/>Contact Support</p>
      </div>
      <div>
        <strong>Company</strong>
        <p>About Us<br/>Careers<br/>Press</p>
      </div>
      <div>
        <strong>Legal</strong>
        <p>Privacy Policy<br/>Terms of Service</p>
      </div>
    </div>
  </footer>
</body>
</html>
